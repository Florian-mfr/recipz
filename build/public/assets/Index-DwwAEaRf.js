import{o as g,c as D,b as o,e as d,n as F,u as U,r as _,h as E,j as q,F as w,a as p,d as r,f as l,k as P,i as z,l as A,t as C,g as k}from"./app-0IfQhdzz.js";import{l as B}from"./lodash-B7kL0Lw1.js";import O from"./Dialog-BQ-8YqpJ.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={__name:"Logo",props:{width:{type:[Number,String],default:"200px"},height:{type:[Number,String],default:"50px"}},setup(v,{expose:e}){e();const t={props:v};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}},Q=["width","height"];function K(v,e,i,t,f,y){return g(),D("svg",{width:i.width,height:i.height,viewBox:"0 0 400 100",xmlns:"http://www.w3.org/2000/svg",style:F({width:typeof i.width=="number"?`${i.width}px`:i.width,height:typeof i.height=="number"?`${i.height}px`:i.height}),preserveAspectRatio:"xMidYMid meet"},[e[0]||(e[0]=o("defs",null,[o("linearGradient",{id:"textGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[o("stop",{offset:"0%",style:{"stop-color":"#3B82F6","stop-opacity":"1"}}),o("stop",{offset:"100%",style:{"stop-color":"#2563EB","stop-opacity":"1"}})])],-1)),d(" Groupe de texte principal "),e[1]||(e[1]=o("g",{transform:"translate(0, 25)"},[d(" DOFUS "),o("text",{x:"0",y:"40","font-family":"'Segoe UI', Roboto, sans-serif","font-size":"42","font-weight":"800",fill:"#1E293B","letter-spacing":"2"}," DOFUS "),d(" CRAFTER "),o("text",{x:"170",y:"40","font-family":"'Segoe UI', Roboto, sans-serif","font-size":"32","font-weight":"600",fill:"url(#textGradient)","letter-spacing":"2"}," CRAFTER ")],-1))],12,Q)}const Y=N(G,[["render",K],["__file","/Users/florian/Desktop/recipz/inertia/components/Logo.vue"]]),H={__name:"Index",props:{craftLists:{type:Array,required:!0},inventory:{type:Array,required:!0}},setup(v,{expose:e}){e();const i=U(),t=v,f=_(t.inventory);E(()=>t.inventory,s=>{f.value=s});const y=q(),S=_(),u=_(!1),a=_(null),h=s=>{w.get(`/crafting-list/${s.data.id}`)},b=s=>{if(!s.items||!s.items.length)return"0/0";const c=s.items.reduce((j,M)=>j+M.resources.reduce((T,V)=>T+V.quantityRequired,0),0);return`${Object.values(s.available_resources||{}).length}/${c}`},L=()=>{a.value=null,u.value=!0},n=s=>{a.value=s,u.value=!0},m=(s,c)=>{f.value.find(x=>x.id===s.id).quantity=c},R=B.debounce(async(s,c)=>{try{console.log(`Mise à jour de l'inventaire pour ${s.resource.name} vers ${c}`),await w.post("/inventory",{resource:s.resource,quantity:c,redirectRoute:"/crafting-list"}),y.add({severity:"success",summary:"Inventaire mis à jour",detail:`Quantité mise à jour pour ${s.resource.name}`,life:3e3})}catch(x){console.log("Erreur lors de la mise à jour de l'inventaire",x),f.value.find(j=>j.id===resource.id).quantity=resource.quantity,y.add({severity:"error",summary:"Erreur",detail:"Erreur lors de la mise à jour de l'inventaire",life:3e3})}},500),I={confirm:i,props:t,inventoryResources:f,toast:y,selectedProduct:S,showDialog:u,selectedCraftList:a,onRowSelect:h,formatMissingResources:b,openCreateDialog:L,openEditDialog:n,updateLocalInventory:m,saveInventory:R,handleInventoryUpdate:(s,c)=>{m(s,c),R(s,c)},confirmDeleteCraftList:s=>{i.require({message:`Voulez vous supprimer votre liste de craft "${s.name}" ?`,header:"Suppression de liste",icon:"pi pi-info-circle",rejectLabel:"Annuler",rejectProps:{label:"Annuler",severity:"secondary",outlined:!0},acceptProps:{label:"Supprimer",severity:"danger"},accept:()=>{w.delete(`/crafting-list/${s.id}`)},reject:()=>{console.log("reject")}})},ref:_,computed:P,watch:E,get Link(){return z},get useToast(){return q},get router(){return w},get useConfirm(){return U},get debounce(){return B.debounce},CraftingListDialog:O,Logo:Y};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}},J={class:"p-4 bg-gray-100 w-[100vw] h-[100vh]"},W={class:"flex items-center gap-2 text-gray-600 mb-2"},X={class:"flex justify-between items-center mb-6"},Z={class:"grid"},$={class:"col-12 lg:col-8 mb-10"},ee={key:0},te={class:"text-primary-600"},oe={class:"flex justify-end"},se={class:"col-12 lg:col-4"},ne={key:0},re={class:"flex items-center gap-2"};function ie(v,e,i,t,f,y){const S=p("ConfirmDialog"),u=p("Button"),a=p("Column"),h=p("DataTable"),b=p("Card"),L=p("InputNumber");return g(),D("div",J,[r(S),d(" En-tête "),o("div",W,[d(' <img src="../../assets/logo.png" alt="logo" class="w-[140px]"/> '),r(t.Link,{href:"/crafting-list",class:"hover:text-primary-500"},{default:l(()=>e[3]||(e[3]=[o("i",{class:"pi pi-home"},null,-1),o("span",{class:"ml-2"},"Accueil",-1)])),_:1})]),o("div",X,[e[4]||(e[4]=o("h1",{class:"text-3xl font-semibold"},"Tableau de bord",-1)),r(u,{icon:"pi pi-plus",label:"Nouvelle liste",onClick:t.openCreateDialog})]),d(" Section des listes de craft "),o("div",Z,[o("div",$,[r(b,null,{title:l(()=>e[5]||(e[5]=[o("div",{class:"flex justify-between items-center"},[o("span",null,"Mes listes de craft")],-1)])),content:l(()=>[i.craftLists.length?(g(),A(h,{key:1,selection:t.selectedProduct,"onUpdate:selection":e[0]||(e[0]=n=>t.selectedProduct=n),value:i.craftLists,rows:5,responsiveLayout:"scroll",class:"p-datatable-sm",selectionMode:"single",dataKey:"id",onRowSelect:t.onRowSelect},{default:l(()=>[r(a,{field:"name",header:"Nom"},{body:l(({data:n})=>[o("div",te,C(n.name),1)]),_:1}),r(a,{header:"Nombre d'items"},{body:l(({data:n})=>[k(C(n.items.length),1)]),_:1}),r(a,{header:"Ressources"},{body:l(({data:n})=>[k(C(t.formatMissingResources(n)),1)]),_:1}),r(a,{field:"updated_at",header:"Dernière modification"},{body:l(({data:n})=>[k(C(new Date(n.updatedAt).toLocaleDateString()),1)]),_:1}),r(a,null,{body:l(({data:n})=>[o("div",oe,[r(u,{icon:"pi pi-pencil",class:"mr-2",onClick:m=>t.openEditDialog(n)},null,8,["onClick"]),r(u,{icon:"pi pi-trash",severity:"danger",onClick:m=>t.confirmDeleteCraftList(n)},null,8,["onClick"])])]),_:1})]),_:1},8,["selection","value"])):(g(),D("div",ee,e[6]||(e[6]=[o("p",{class:"text-gray-500 text-center"},"Aucune liste de craft pour le moment",-1)])))]),_:1})]),d(" Section inventaire "),o("div",se,[r(b,null,{title:l(()=>e[7]||(e[7]=[o("div",{class:"flex justify-between items-center"},[o("span",null,"Mes ressources")],-1)])),content:l(()=>[t.inventoryResources.length?(g(),A(h,{key:1,value:t.inventoryResources,rows:5,class:"p-datatable-sm"},{default:l(()=>[r(a,{field:"resource.name",header:"Ressource"}),r(a,{field:"quantity",header:"Quantité"},{body:l(({data:n})=>[o("div",re,[r(L,{"model-value":n.quantity,min:0,showButtons:"",class:"w-32","onUpdate:modelValue":m=>t.handleInventoryUpdate(n,m)},null,8,["model-value","onUpdate:modelValue"])])]),_:1})]),_:1},8,["value"])):(g(),D("div",ne,e[8]||(e[8]=[o("p",{class:"text-gray-500 text-center"},"Aucune ressource récente",-1)])))]),_:1})])]),d(" Dialog création de liste "),r(t.CraftingListDialog,{modelValue:t.showDialog,"onUpdate:modelValue":e[1]||(e[1]=n=>t.showDialog=n),"craft-list":t.selectedCraftList,"redirect-route":"/crafting-list","redirect-route-options":{preserveScroll:!0},onClose:e[2]||(e[2]=n=>t.selectedCraftList=null)},null,8,["modelValue","craft-list"])])}const me=N(H,[["render",ie],["__scopeId","data-v-1ebb4916"],["__file","/Users/florian/Desktop/recipz/inertia/pages/CraftingList/Index.vue"]]);export{me as default};
